<%= render 'shared/static_header' %>

<section class="list_of_moves_page">
  <div class="col-md-4">
  </div>
  <div class="col-md-4 up-col-md-12">
    <div class="col-md-12 up-col-md-12">
      <div class="upcoming_moves">Upcoming Moves</div>
      <div class="upcoming_values">
      </div>
    </div>
    <div class="col-md-12 up-col-md-12">
      <div class="past_moves">Past Moves</div>
      <div class="past_values">
      </div>
    </div>
  </div>
  <div class="col-md-4">
  </div>
</section>

<%= render 'footer' %>
<%= render 'home/top_mbl_side_nav' %>

<script type="text/javascript">
  $(document).ready(function(){
    var current_user = localStorage.getItem('user_id');
    var API_URL = "http://45.56.72.52/api/userapi/";
    var user_params = '{"user_id": '+ current_user +'}'
    console.log(user_params)
    if (current_user != "" && current_user != null && current_user != undefined) {
      $.ajax({
        url: API_URL+'getMovingRequestList',
        type: 'POST',
        data: user_params,
      })
      .done(function(data) {
        console.log(data.data.past);
        // alert(data.data)
        // if (data.data.upcoming)
        $.each(data.data.upcoming ,function(key, res){
          var upcoming = '<div class="um-values"><h4>'+res.moving_code+'</h4><p>Awaiting Proposals</p><p>'+res.room_type_name+'</p><p>'+res.move_date_time+'</p><p>'+res.from_address+'</p><p>'+res.to_address+'</p></div><hr>'
          $('.upcoming_values').append(upcoming)
        });

        $.each(data.data.past ,function(key, res){
          var upcoming = '<div class="um-values"><h4>'+res.moving_code+'</h4><p>Awaiting Proposals</p><p>'+res.room_type_name+'</p><p>'+res.move_date_time+'</p><p>'+res.from_address+'</p><p>'+res.to_address+'</p></div><hr>'
          $('.past_values').append(upcoming)
        });

      })
      .fail(function(data) {
         $('.past_values').html('<div class="um-values"><p class="no-move-data">No Detail Found</p></div>');
        $('.upcoming_values').html('<div class="um-values"><p class="no-move-data">No Detail Found</p></div>');
      });
    }
  });
</script>